\chapter{METHODOLOGY} \label{chap:methodology}
    %\doublespacing
    \minitoc
    
    \newpage
    \begin{center}
    	\emph{Abstract of chapter \ref{chap:methodology}}
    \end{center}
    
    Insert abstract here.
    
    \section{Spectral Study of Supersoft X-ray Sources} \label{methodology:spectral}
    	
    	
    \section{Variability Study of Supersoft X-ray Sources} \label{methodology:variability}
    
    	\subsection{Introduction to Lomb-Scargle Periodogram}
    		%Introduce the concept of periodograms, emphasizing their role in time series analysis for detecting periodic signals.
    		Periodograms are a versatile tool for identifying and quantifying periodic patterns within data. By transforming a time series into the frequency domain, periodograms reveal the frequencies at which the signal exhibits significant power. This spectral analysis is invaluable for detecting periodic components that might be obscured in the original time domain representation.
    		
    		The height of peaks in a periodogram provides an estimate of the amplitude of the corresponding periodic component. This allows for a quantitative assessment of the strength of periodic signals. Additionally, the frequency of these peaks directly indicates the periodicity of the underlying patterns.
    		
    		While traditional periodograms are well-suited for uniformly sampled data, their applicability can be limited when dealing with irregularly spaced time series. In such scenario, the Lomb-Scargle periodogram emerges as a viable alternative \cite{lomb1976least,scargle1982studies}. Specifically designed to handle unevenly spaced data, the Lomb-Scargle periodogram accounts for gaps in the time series, providing a robust and reliable method for detecting periodic signals.
    		
    		\subsubsection{Historical Background}
    		
    		\subsubsection{Importance in Astrophysics}
    	
    	\subsection{Theory of Lomb-Scargle Periodogram}
    	
    		\subsubsection{Uniform and non-uniform sampling of data}
    			\paragraph{Uniform sampling of data:}
    			Suppose that $g(t)$ is a \textit{signal function} and $W(t)$ represents the observation \textit{window function}, then the observed signal is represented by the following function:
    			\begin{align}
    				g_\text{obs}(t)=g(t)W(t) \label{eqn:obs-func}
    			\end{align}
    			Then, by the Fourier convolution theorem, we have,
    			\begin{align}
    				\mathscr{F}\left\lbrace g_\text{obs} \right\rbrace = \mathscr{F}\left\lbrace g(t) \right\rbrace * \mathscr{F}\left\lbrace W(t) \right\rbrace \label{eqn:FT-obs-func}
    			\end{align}
    			In the case of the discrete Fourier transform, where the continuous signal is sampled at regular intervals, the window function becomes a Dirac comb, which is a regular grid of Dirac delta functions with spacing of $\Delta t$, i.e.
    			\begin{align}
    				W(t)=\text{III}_{\Delta t}(t)=\sum_{n=-\infty}^{\infty}{\delta(t-n\Delta t)} \label{eqn:dirac-comb}
    			\end{align}
    			
    			Hence, equation \ref{eqn:obs-func} becomes
    			\begin{align}
    				g_\text{obs}(t)=g(t)\text{III}_{\Delta t}(t) \label{eqn:obs-func:dft}
    			\end{align}
    			Taking the Fourier transform of equation (\ref{eqn:obs-func:dft}), we can have
    			\begin{align}
    				\hat{g}_\text{obs}(f)&=\FT{g_\text{obs}(t)}{f} \nonumber \\
    					&=\FT{g(t)\text{III}_{\Delta t}(t)}{f} \nonumber \\
    					&=\FT{g(t)\left\lbrace \sum_{n=-\infty}^{\infty}{\delta(t-n\Delta t)} \right\rbrace}{f} \nonumber \\
    					&=\sum_{n=-\infty}^{\infty}{\int_{-\infty}^{\infty}{\delta(t-n\Delta t)g(t)e^{-2\pi ift}\diff{t}}} \nonumber \\
    				\implies\hat{g}_\text{obs}(f)&=\sum_{n=-\infty}^{\infty}{g(n\Delta t)e^{-2\pi ift}} \label{eqn:dft-01}
    			\end{align}
    			In case of a finite number $N$ of samples, we can express $g(n\Delta t)=g_n$ and so equation (\ref{eqn:dft-01}) becomes
    			\begin{align}
    				\hat{g}_\text{obs}(f)&=\sum_{n=0}^{N}{g_ne^{-2\pi ifn\Delta t}} \label{eqn:dft-02}
    			\end{align}
    			As per the Nyquist limit, the frequency range of relevance is $0\leqslant f\leqslant\dfrac{1}{\Delta t}$. This range can be evenly spaced into $N$ intervals with
    			\begin{align*}
    				\Delta f&=\dfrac{1/{\Delta t}}{N}=\dfrac{1}{N\Delta t} \\
    				\implies\Delta f\Delta t&=\dfrac{1}{N}
    			\end{align*}
    			Let the frequency range be spaced by $\Delta f$, i.e. $f=k\Delta f$, where $k$ is an integer. Then from equation (\ref{eqn:dft-02}), we obtain
    			\begin{align}
    				\hat{g}_\text{obs}(k\Delta f)&=\sum_{n=0}^{N}{g_ne^{-2\pi ik\Delta fn\Delta t}} \nonumber \\
    				\implies \hat{g}_k&=\sum_{n=0}^{N}{g_ne^{-2\pi ikn/N}} \label{eqn:dft-03}
    			\end{align}
    			Here, equation (\ref{eqn:dft-03}) gives the expression for the implementation of the discrete Fourier transform.
    			
    			From the DFT in equation (\ref{eqn:dft-03}), we can compute the \textit{classical periodogram} or \textit{Schuster periodogram} \cite{schuster1898investigation} as $\dfrac{1}{N}$ times the Fourier power spectrum for a continuous signal observed with uniform sampling using a Dirac comb:
    			\begin{align}
    				P_s(f)=\dfrac{1}{N}\left| \sum_{n=1}^{N}{g_ne^{-2\pi i ft_n}} \right|^2 \label{eqn:schuster-periodogram}
    			\end{align}
    			It must be clarified here that the periodogram is a statistic which is computed from the data and it is used to estimate the power spectrum of the underlying continuous signal of interest.
    			
    			In real-world observational fields such as astronomy, data collection is often subjected to a range of constraints and variability, leading to non-uniform sampling. Unlike controlled experiments where conditions can be held constant, astronomical observations by space-based observatories are influenced by a variety of factors:
    			\begin{enumerate}[i.]
    				\item \textit{Orbital constraints}: Space-based telescopes are often in specific orbits around the Earth, the Moon, or even the Sun. These orbits dictate observation windows and create periods when the telescope cannot point at certain objects due to the Sun, Earth, or other celestial bodies obstructing the line of sight.
    				\item \textit{Sun avoidance regions}: To prevent damage to sensitive instruments, space-based telescopes typically have sun avoidance zones where they cannot observe. This limits the ability to track certain objects continuously, leading to gaps in data collection.
    				\item \textit{Limited data storage and downlink bandwidth}: Space telescopes have finite onboard data storage and are dependent on ground stations for data downlink. Periods when the telescope is out of communication range or when storage reaches capacity can result in interruptions in data collection.
    				\item \textit{Thermal constraints and cooling periods}: Space-based telescopes equipped with infrared sensors or other heat-sensitive instruments may require cooling periods or specific thermal management strategies. This can restrict observation times and introduce non-uniform sampling in the data.
    				\item \textit{Instrument maintenance and calibration}: Routine instrument calibration and maintenance activities can lead to temporary suspension of scientific observations, causing gaps in data collection.
    			\end{enumerate}
    			These factors create unevenly spaced data points that pose significant challenges for the discrete Fourier transform, which is built on the assumption of uniform sampling intervals.
    			
    			\paragraph{Non-uniform sampling of data:}
    			In case the observed data is a signal that is sampled over a set of $N$ times, i.e. $\{t_n\}$, and so the window function my be expressed as
    			\begin{align}
    				W_{\{t_n\}}(t)=\sum_{n=1}^{N}{\delta(t-t_n)} \label{eqn:nonunif-dirac-comb}
    			\end{align}
    			In this scenario, upon applying the window function to the underlying continuous signal, the observed signal is obtained to be of the form:
    			\begin{align}
    				g_\text{obs}(t)&=g(t)W_{\{t_n\}}(t) \nonumber \\
    				\implies g_\text{obs}(t)&=\sum_{n=1}^{N}{g(t)\delta(t-t_n)} \label{eqn:obs-func-nonunif}
    			\end{align}
    			The Fourier transform of the observed signal is obtained using the convolution theorem to be as follows
    			\begin{align}
    				\mathscr{F}\{g_\text{obs}\}=\mathscr{F}\{g(t)\}*\mathscr{F}\{W_{\{t_n\}}(t)\} \label{eqn:FT-obs-func-nonunif}
    			\end{align}
    			However, in this case, the Fourier transform of the window function $W_{\{t_n\}}(t)$ would not be a Dirac comb. Rather, it would be noisier because the observation times have undergone randomization. Even though this noise may be reduced to a certain degree by increasing the number of observations, it would still persist. Also, increasing the number of observations might not be practically feasible in situation, such as in astronomy.
    				
    		\subsubsection{Mathematical Formulation of Lomb-Scargle Periodogram}
    			Using Euler's formula, the classical periodogram given in equation (\ref{eqn:schuster-periodogram}) can be re-cast in the following manner:
    			\begin{align}
    				P(f)&=\dfrac{1}{N}\left| \sum_{n=1}^{N}{g_ne^{-2\pi i ft_n}} \right|^2 \nonumber \\
    				\implies P(f)&=\dfrac{1}{N}\left[ \left\lbrace \sum_{n=1}^{N}{g_n\cos{(2\pi ft_n)}} \right\rbrace^2 + \left\lbrace \sum_{n=1}^{N}{g_n\sin{(2\pi ft_n)}} \right\rbrace^2 \right] \label{eqn:lomb-scargle-01}
    			\end{align}
    			%When the classical periodogram is applied to uniformly-sampled Gaussian noise, the resulting periodogram becomes a $\chi^2$ distribution. However, this does not hold good when the sampling becomes nonuniform, with the end result being that the periodogram distribution cannot, in general, be analytically expressed.
    			When the classical periodogram is applied to uniformly-sampled Gaussian noise, its distribution converges asymptotically to a $\chi^2$ distribution with known degrees of freedom, this property being contingent upon the assumption of uniform sampling. For non-uniformly sampled data, the distribution of the periodogram becomes considerably more complex, and a closed-form analytical expression is generally intractable.
    			
    			To address this issue, Scargle generalized the periodogram in equation (\ref{eqn:lomb-scargle-01}) as follows \cite{scargle1982studies}:
    			\begin{align}
    				P(f)&=\dfrac{A^2}{2}\left\lbrace \sum_{n=1}^{N}{g_n\cos{[2\pi f(t_n-\tau)]}} \right\rbrace^2 + \dfrac{B^2}{2}\left\lbrace \sum_{n=1}^{N}{g_n\sin{[2\pi f(t_n-\tau)]}} \right\rbrace^2 \label{eqn:lomb-scargle-02}
    			\end{align}
    			where $A$, $B$ and $\tau$ are arbitrary functions of the frequencies $f$ and the observing times $\{t_i\}$. Scargle also showed that one can choose unique forms of $A$, $B$ and $\tau$ in a manner such that we have the periodogram in equation (\ref{eqn:lomb-scargle-02})
    			\begin{enumerate}[a)]
    				\item reducing to the classical form in equation (\ref{eqn:schuster-periodogram}) in case the observations are uniformly sampled.
    				\item having statistics which are analytically computable.
    				\item becoming insensitive to global time-shifts in data.
    			\end{enumerate}
    			The functions of $A$, $B$ and $\tau$ that provide the above properties are
    			\begin{align*}
    				A&=\dfrac{1}{\sqrt{\sum_{n}{\cos^2{[2\pi f(t_n-\tau)]}}}} \\
    				B&=\dfrac{1}{\sqrt{\sum_{n}{\sin^2{[2\pi f(t_n-\tau)]}}}} \\
    				\tau&=\dfrac{1}{4\pi f}\tan^{-1}{\left\lbrace \dfrac{\sum_{n}{\sin{[4\pi ft_n)]}}}{\sum_{n}{\cos{[4\pi ft_n)]}}} \right\rbrace}
    			\end{align*}
    			In the above, the function $\tau$ ensures the time-shift invariance of the Lomb-Scargle periodogram. A notable feature of the Lomb-Scargle periodogram is its equivalence to the result obtained from fitting a simple sinusoidal model to the data at each frequency $f$ and constructing a periodogram from the $\chi^2$ goodness-of-fit statistic at each frequency. This approach allows the periodogram to be viewed as a measure of how well a sine wave of a given frequency fits the observational data. In this context, the introduction of the $\tau$ shift is crucial, as it serves to orthogonalize the normal equations used in the least squares fitting process. This orthogonalization ensures that the fitting procedure is unbiased and more computationally stable. This deep connection between traditional Fourier analysis and least-squares analysis has led to the widespread adoption of the term \textit{Lomb-Scargle periodogram} to describe this methodology, even though variants of this approach were utilized prior to Lomb and Scargle's formalization.
    			
    			%The similarity between the classical Fourier-based periodograms and the Lomb-Scargle periodograms implies that much of the theoretical reasoning developed for the former is also qualitatively applicable to the latter. For instance, the influence of window functions, which modify the observed power spectrum due to finite observation times, is still relevant when interpreting the results of the Lomb-Scargle periodogram, although quantitative predictions may differ. However, a key limitation of the standard Lomb-Scargle formulation is its reliance on the assumption that observational noise is uncorrelated white noise. In cases where the data contain more complex noise characteristics, such as coloured noise or correlated observational errors, the statistical guarantees provided by the Lomb-Scargle method may no longer hold, necessitating more advanced modifications or alternative approaches to accurately interpret the variability signals present in the data.
    		
    		\subsubsection{Uncertainties in Periodogram Results}
    			A critical aspect of reporting results derived from the Lomb-Scargle periodogram is the quantification of uncertainty associated with the estimated period. While traditional approaches often rely on error bars to express uncertainty, such a metric may be less meaningful in the context of Lomb-Scargle periodograms. The primary concern with periodograms is often the presence of false peaks or aliases, rather than a continuous distribution of potential period values around a true estimate. This disjointed nature of uncertainty necessitates a more nuanced approach to quantifying the reliability of the estimated period.
    			
    			\paragraph{Peak width and frequency precision:}
    			The presence of a peak within the Lomb-Scargle periodogram, characterized by its width and height, signifies the existence of a periodic signal. In the Fourier domain, the precision with which a peak's frequency can be identified is directly correlated with its width. A common metric for quantifying this width is the half-width at half-maximum, denoted by $f_{1/2}\approx T$.
    			
    			A more rigorous framework for assessing uncertainty can be established within the context of least squares analysis. In this interpretation, the inverse of the peak's curvature is directly related to the uncertainty in the estimated frequency. This perspective aligns with the Bayesian approach, which involves fitting a Gaussian curve to the exponentiated peak. The Bayesian uncertainty in the frequency estimate is influenced by both the number of samples $N$, and the average signal-to-noise ratio $\Sigma$. The scaling of this uncertainty can be approximated by the standard deviation of the estimated frequency:
    			\begin{align}
    				\sigma_f\approx\sqrt{\dfrac{2}{N\Sigma^2}} \label{eqn:stddev-est-freq}
    			\end{align}
    			This dependence arise from the fact that the Bayesian uncertainty is linked to the width of the exponentiated periodogram, which in turn is influenced by the %peak's height ​.
    	
    	\subsection{Implementation of Lomb-Scargle Periodogram}
    	
    		\subsubsection{Computational Techniques}
    		
    		\subsubsection{Software Tools and Libraries}
    	